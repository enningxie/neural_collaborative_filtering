MLP arguments: Namespace(batch_size=4096, dataset='ml-1m', epochs=100, layers='[64, 32,16,8]', learner='adam', lr=0.001, num_neg=4, out=1, path='Data/', reg_layers='[0,0,0,0]', verbose=1) 
Load data done [11.7 s]. #user=6040, #item=3706, #train=994169, #test=6040
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
user_input (InputLayer)         (None, 1)            0                                            
__________________________________________________________________________________________________
item_input (InputLayer)         (None, 1)            0                                            
__________________________________________________________________________________________________
user_embedding (Embedding)      (None, 1, 32)        193280      user_input[0][0]                 
__________________________________________________________________________________________________
item_embedding (Embedding)      (None, 1, 32)        118592      item_input[0][0]                 
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 32)           0           user_embedding[0][0]             
__________________________________________________________________________________________________
flatten_2 (Flatten)             (None, 32)           0           item_embedding[0][0]             
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 64)           0           flatten_1[0][0]                  
                                                                 flatten_2[0][0]                  
__________________________________________________________________________________________________
layer1 (Dense)                  (None, 32)           2080        concatenate_1[0][0]              
__________________________________________________________________________________________________
layer2 (Dense)                  (None, 16)           528         layer1[0][0]                     
__________________________________________________________________________________________________
layer3 (Dense)                  (None, 8)            136         layer2[0][0]                     
__________________________________________________________________________________________________
prediction (Dense)              (None, 1)            9           layer3[0][0]                     
==================================================================================================
Total params: 314,625
Trainable params: 314,625
Non-trainable params: 0
__________________________________________________________________________________________________
None
Init: HR = 0.0899, NDCG = 0.0426 [14.6]
Iteration 0 [23.0 s]: HR = 0.4465, NDCG = 0.2490, loss = 0.3729 [9.6 s]
Iteration 1 [21.6 s]: HR = 0.5065, NDCG = 0.2802, loss = 0.3392 [8.7 s]
Iteration 2 [21.4 s]: HR = 0.5695, NDCG = 0.3194, loss = 0.3128 [8.7 s]
Iteration 3 [22.3 s]: HR = 0.5932, NDCG = 0.3311, loss = 0.2956 [9.2 s]
Iteration 4 [21.3 s]: HR = 0.6050, NDCG = 0.3425, loss = 0.2843 [8.6 s]
Iteration 5 [21.6 s]: HR = 0.6189, NDCG = 0.3510, loss = 0.2752 [8.5 s]
Iteration 6 [21.6 s]: HR = 0.6240, NDCG = 0.3575, loss = 0.2695 [9.2 s]
Iteration 7 [21.2 s]: HR = 0.6396, NDCG = 0.3648, loss = 0.2648 [8.9 s]
Iteration 8 [22.0 s]: HR = 0.6457, NDCG = 0.3715, loss = 0.2609 [8.3 s]
Iteration 9 [21.1 s]: HR = 0.6459, NDCG = 0.3713, loss = 0.2575 [9.0 s]
Iteration 10 [21.7 s]: HR = 0.6437, NDCG = 0.3733, loss = 0.2546 [8.9 s]
Iteration 11 [21.8 s]: HR = 0.6469, NDCG = 0.3780, loss = 0.2521 [9.3 s]
Iteration 12 [21.7 s]: HR = 0.6518, NDCG = 0.3798, loss = 0.2497 [9.0 s]
Iteration 13 [21.4 s]: HR = 0.6536, NDCG = 0.3812, loss = 0.2477 [9.6 s]
Iteration 14 [21.6 s]: HR = 0.6568, NDCG = 0.3816, loss = 0.2456 [8.6 s]
Iteration 15 [21.5 s]: HR = 0.6495, NDCG = 0.3790, loss = 0.2436 [8.7 s]
Iteration 16 [21.5 s]: HR = 0.6584, NDCG = 0.3850, loss = 0.2422 [9.2 s]
Iteration 17 [21.5 s]: HR = 0.6563, NDCG = 0.3829, loss = 0.2407 [8.6 s]
Iteration 18 [22.3 s]: HR = 0.6560, NDCG = 0.3881, loss = 0.2394 [8.7 s]
Iteration 19 [21.8 s]: HR = 0.6565, NDCG = 0.3886, loss = 0.2378 [9.1 s]
Iteration 20 [21.5 s]: HR = 0.6507, NDCG = 0.3840, loss = 0.2368 [8.7 s]
Iteration 21 [21.6 s]: HR = 0.6555, NDCG = 0.3868, loss = 0.2358 [8.7 s]
Iteration 22 [21.9 s]: HR = 0.6575, NDCG = 0.3867, loss = 0.2347 [9.0 s]
Iteration 23 [21.5 s]: HR = 0.6543, NDCG = 0.3873, loss = 0.2337 [8.9 s]
Iteration 24 [21.4 s]: HR = 0.6555, NDCG = 0.3876, loss = 0.2325 [8.7 s]
Iteration 25 [21.7 s]: HR = 0.6589, NDCG = 0.3887, loss = 0.2321 [9.2 s]
Iteration 26 [21.7 s]: HR = 0.6571, NDCG = 0.3868, loss = 0.2311 [9.1 s]
Iteration 27 [20.9 s]: HR = 0.6513, NDCG = 0.3855, loss = 0.2302 [8.9 s]
Iteration 28 [22.0 s]: HR = 0.6589, NDCG = 0.3889, loss = 0.2295 [8.5 s]
Iteration 29 [21.5 s]: HR = 0.6578, NDCG = 0.3856, loss = 0.2289 [8.9 s]
Iteration 30 [21.4 s]: HR = 0.6606, NDCG = 0.3915, loss = 0.2282 [8.6 s]
Iteration 31 [20.9 s]: HR = 0.6583, NDCG = 0.3876, loss = 0.2276 [9.4 s]
Iteration 32 [22.0 s]: HR = 0.6619, NDCG = 0.3900, loss = 0.2270 [8.4 s]
Iteration 33 [21.6 s]: HR = 0.6533, NDCG = 0.3857, loss = 0.2265 [8.7 s]
Iteration 34 [21.5 s]: HR = 0.6571, NDCG = 0.3859, loss = 0.2259 [9.0 s]
Iteration 35 [21.6 s]: HR = 0.6565, NDCG = 0.3882, loss = 0.2255 [9.5 s]
Iteration 36 [21.9 s]: HR = 0.6556, NDCG = 0.3862, loss = 0.2250 [8.5 s]
Iteration 37 [21.5 s]: HR = 0.6520, NDCG = 0.3853, loss = 0.2248 [8.9 s]
Iteration 38 [21.0 s]: HR = 0.6556, NDCG = 0.3871, loss = 0.2242 [8.9 s]
Iteration 39 [21.6 s]: HR = 0.6538, NDCG = 0.3895, loss = 0.2240 [8.6 s]
Iteration 40 [21.6 s]: HR = 0.6588, NDCG = 0.3891, loss = 0.2235 [9.2 s]
Iteration 41 [21.5 s]: HR = 0.6536, NDCG = 0.3880, loss = 0.2230 [8.7 s]
Iteration 42 [21.7 s]: HR = 0.6584, NDCG = 0.3874, loss = 0.2227 [8.9 s]
Iteration 43 [21.7 s]: HR = 0.6596, NDCG = 0.3897, loss = 0.2223 [9.9 s]
Iteration 44 [21.6 s]: HR = 0.6503, NDCG = 0.3862, loss = 0.2218 [8.6 s]
Iteration 45 [21.3 s]: HR = 0.6536, NDCG = 0.3865, loss = 0.2215 [8.5 s]
Iteration 46 [21.3 s]: HR = 0.6540, NDCG = 0.3868, loss = 0.2213 [8.8 s]
Iteration 47 [21.3 s]: HR = 0.6601, NDCG = 0.3902, loss = 0.2208 [9.0 s]
Iteration 48 [21.3 s]: HR = 0.6586, NDCG = 0.3884, loss = 0.2208 [10.4 s]
Iteration 49 [21.6 s]: HR = 0.6583, NDCG = 0.3888, loss = 0.2201 [8.7 s]
Iteration 50 [21.2 s]: HR = 0.6553, NDCG = 0.3888, loss = 0.2199 [9.3 s]
Iteration 51 [21.5 s]: HR = 0.6550, NDCG = 0.3888, loss = 0.2196 [8.7 s]
Iteration 52 [21.7 s]: HR = 0.6528, NDCG = 0.3867, loss = 0.2193 [8.5 s]
Iteration 53 [21.8 s]: HR = 0.6507, NDCG = 0.3876, loss = 0.2193 [8.9 s]
Iteration 54 [21.1 s]: HR = 0.6573, NDCG = 0.3883, loss = 0.2193 [8.9 s]
Iteration 55 [21.5 s]: HR = 0.6591, NDCG = 0.3913, loss = 0.2186 [9.0 s]
Iteration 56 [21.2 s]: HR = 0.6533, NDCG = 0.3895, loss = 0.2184 [8.6 s]
Iteration 57 [21.7 s]: HR = 0.6558, NDCG = 0.3870, loss = 0.2182 [9.4 s]
Iteration 58 [21.3 s]: HR = 0.6598, NDCG = 0.3919, loss = 0.2180 [8.8 s]
Iteration 59 [20.9 s]: HR = 0.6563, NDCG = 0.3897, loss = 0.2176 [8.3 s]
Iteration 60 [21.5 s]: HR = 0.6535, NDCG = 0.3863, loss = 0.2174 [9.0 s]
Iteration 61 [21.4 s]: HR = 0.6563, NDCG = 0.3876, loss = 0.2172 [9.2 s]
Iteration 62 [21.3 s]: HR = 0.6505, NDCG = 0.3868, loss = 0.2168 [9.1 s]
Iteration 63 [21.8 s]: HR = 0.6531, NDCG = 0.3877, loss = 0.2169 [8.9 s]
Iteration 64 [21.8 s]: HR = 0.6478, NDCG = 0.3865, loss = 0.2165 [8.9 s]
Iteration 65 [21.7 s]: HR = 0.6512, NDCG = 0.3891, loss = 0.2163 [8.7 s]
Iteration 66 [21.8 s]: HR = 0.6528, NDCG = 0.3852, loss = 0.2160 [8.4 s]
Iteration 67 [21.7 s]: HR = 0.6498, NDCG = 0.3876, loss = 0.2160 [8.9 s]
Iteration 68 [21.9 s]: HR = 0.6538, NDCG = 0.3906, loss = 0.2157 [8.9 s]
Iteration 69 [21.8 s]: HR = 0.6470, NDCG = 0.3858, loss = 0.2155 [8.8 s]
Iteration 70 [20.9 s]: HR = 0.6530, NDCG = 0.3903, loss = 0.2155 [9.1 s]
Iteration 71 [21.8 s]: HR = 0.6536, NDCG = 0.3888, loss = 0.2154 [8.5 s]
Iteration 72 [21.5 s]: HR = 0.6480, NDCG = 0.3851, loss = 0.2152 [8.8 s]
Iteration 73 [21.4 s]: HR = 0.6515, NDCG = 0.3860, loss = 0.2147 [9.1 s]
Iteration 74 [21.8 s]: HR = 0.6500, NDCG = 0.3865, loss = 0.2146 [8.3 s]
Iteration 75 [21.5 s]: HR = 0.6520, NDCG = 0.3873, loss = 0.2149 [8.5 s]
Iteration 76 [22.0 s]: HR = 0.6470, NDCG = 0.3841, loss = 0.2146 [8.8 s]
Iteration 77 [29.4 s]: HR = 0.6464, NDCG = 0.3820, loss = 0.2147 [10.0 s]
Iteration 78 [21.8 s]: HR = 0.6459, NDCG = 0.3832, loss = 0.2140 [8.6 s]
Iteration 79 [21.2 s]: HR = 0.6472, NDCG = 0.3864, loss = 0.2143 [8.6 s]
Iteration 80 [23.4 s]: HR = 0.6485, NDCG = 0.3871, loss = 0.2139 [8.8 s]
Iteration 81 [21.9 s]: HR = 0.6457, NDCG = 0.3819, loss = 0.2136 [9.8 s]
Iteration 82 [21.9 s]: HR = 0.6513, NDCG = 0.3859, loss = 0.2135 [9.7 s]
Iteration 83 [22.1 s]: HR = 0.6513, NDCG = 0.3853, loss = 0.2133 [9.0 s]
Iteration 84 [21.4 s]: HR = 0.6493, NDCG = 0.3853, loss = 0.2135 [8.7 s]
Iteration 85 [21.3 s]: HR = 0.6457, NDCG = 0.3837, loss = 0.2132 [9.6 s]
Iteration 86 [22.1 s]: HR = 0.6460, NDCG = 0.3833, loss = 0.2129 [9.1 s]
Iteration 87 [21.8 s]: HR = 0.6412, NDCG = 0.3822, loss = 0.2133 [9.0 s]
Iteration 88 [21.4 s]: HR = 0.6478, NDCG = 0.3860, loss = 0.2127 [8.9 s]
Iteration 89 [21.9 s]: HR = 0.6490, NDCG = 0.3851, loss = 0.2128 [9.2 s]
Iteration 90 [20.9 s]: HR = 0.6450, NDCG = 0.3823, loss = 0.2126 [9.4 s]
Iteration 91 [21.1 s]: HR = 0.6498, NDCG = 0.3864, loss = 0.2124 [8.4 s]
Iteration 92 [22.1 s]: HR = 0.6475, NDCG = 0.3857, loss = 0.2122 [8.9 s]
Iteration 93 [21.1 s]: HR = 0.6460, NDCG = 0.3833, loss = 0.2122 [8.9 s]
Iteration 94 [21.8 s]: HR = 0.6485, NDCG = 0.3856, loss = 0.2120 [8.8 s]
Iteration 95 [21.8 s]: HR = 0.6469, NDCG = 0.3834, loss = 0.2118 [8.9 s]
Iteration 96 [21.4 s]: HR = 0.6488, NDCG = 0.3841, loss = 0.2117 [8.4 s]
Iteration 97 [20.9 s]: HR = 0.6440, NDCG = 0.3824, loss = 0.2116 [8.6 s]
Iteration 98 [21.8 s]: HR = 0.6477, NDCG = 0.3855, loss = 0.2117 [8.8 s]
Iteration 99 [22.0 s]: HR = 0.6445, NDCG = 0.3830, loss = 0.2115 [8.8 s]
End. Best Iteration 32:  HR = 0.6619, NDCG = 0.3900. 
The best MLP model is saved to Pretrain/ml-1m_MLP_[64, 32,16,8]_1524845839.h5
