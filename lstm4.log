MLP arguments: Namespace(batch_size=16384, dataset='ml-1m', epochs=100, layers='[64, 32,16,8]', learner='adam', lr=0.001, num_neg=4, out=1, path='Data/', reg_layers='[0,0,0,0]', train_pd_path='./Data/ratings_train.csv', verbose=1) 
Load data done [12.6 s]. #user=6040, #item=3706, #train=994169, #test=6040
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
user_input (InputLayer)         (None, 1)            0                                            
__________________________________________________________________________________________________
item_input (InputLayer)         (None, 1)            0                                            
__________________________________________________________________________________________________
user_embedding (Embedding)      (None, 1, 32)        118592      user_input[0][0]                 
__________________________________________________________________________________________________
item_embedding (Embedding)      (None, 1, 32)        118592      item_input[0][0]                 
__________________________________________________________________________________________________
user_xz_input (InputLayer)      (None, 19)           0                                            
__________________________________________________________________________________________________
flatten_1 (Flatten)             (None, 32)           0           user_embedding[0][0]             
__________________________________________________________________________________________________
flatten_2 (Flatten)             (None, 32)           0           item_embedding[0][0]             
__________________________________________________________________________________________________
user_xz_embedding (Embedding)   (None, 19, 64)       386560      user_xz_input[0][0]              
__________________________________________________________________________________________________
u_i_con (Concatenate)           (None, 64)           0           flatten_1[0][0]                  
                                                                 flatten_2[0][0]                  
__________________________________________________________________________________________________
lstm_1 (LSTM)                   (None, 64)           33024       user_xz_embedding[0][0]          
__________________________________________________________________________________________________
add_1 (Add)                     (None, 64)           0           u_i_con[0][0]                    
                                                                 lstm_1[0][0]                     
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 128)          8320        add_1[0][0]                      
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 64)           8256        dense_1[0][0]                    
__________________________________________________________________________________________________
dense_3 (Dense)                 (None, 32)           2080        dense_2[0][0]                    
__________________________________________________________________________________________________
dense_4 (Dense)                 (None, 16)           528         dense_3[0][0]                    
__________________________________________________________________________________________________
prediction (Dense)              (None, 1)            17          dense_4[0][0]                    
==================================================================================================
Total params: 675,969
Trainable params: 675,969
Non-trainable params: 0
__________________________________________________________________________________________________
None
Init: HR = 0.1055, NDCG = 0.0487 [65.0]
Iteration 0 [62.0 s]: HR = 0.4513, NDCG = 0.2510, loss = 0.3996 [64.7 s]
Iteration 1 [66.3 s]: HR = 0.4810, NDCG = 0.2690, loss = 0.3478 [65.9 s]
Iteration 2 [57.6 s]: HR = 0.5248, NDCG = 0.2937, loss = 0.3269 [63.3 s]
Iteration 3 [60.4 s]: HR = 0.5558, NDCG = 0.3140, loss = 0.3081 [63.2 s]
Iteration 4 [57.6 s]: HR = 0.5876, NDCG = 0.3303, loss = 0.2942 [64.6 s]
Iteration 5 [59.0 s]: HR = 0.5992, NDCG = 0.3429, loss = 0.2845 [64.1 s]
Iteration 6 [60.9 s]: HR = 0.6154, NDCG = 0.3546, loss = 0.2769 [63.1 s]
Iteration 7 [57.9 s]: HR = 0.6187, NDCG = 0.3559, loss = 0.2709 [63.6 s]
Iteration 8 [59.1 s]: HR = 0.6238, NDCG = 0.3579, loss = 0.2654 [62.3 s]
Iteration 9 [58.7 s]: HR = 0.6318, NDCG = 0.3675, loss = 0.2609 [63.0 s]
Iteration 10 [60.6 s]: HR = 0.6339, NDCG = 0.3695, loss = 0.2567 [63.5 s]
Iteration 11 [59.6 s]: HR = 0.6422, NDCG = 0.3780, loss = 0.2531 [63.6 s]
Iteration 12 [58.9 s]: HR = 0.6518, NDCG = 0.3806, loss = 0.2502 [62.9 s]
Iteration 13 [58.6 s]: HR = 0.6503, NDCG = 0.3805, loss = 0.2478 [62.8 s]
Iteration 14 [59.7 s]: HR = 0.6407, NDCG = 0.3760, loss = 0.2453 [64.3 s]
Iteration 15 [59.5 s]: HR = 0.6520, NDCG = 0.3784, loss = 0.2432 [62.8 s]
